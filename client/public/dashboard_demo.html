<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Demo - US03 | SmartWallet</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <link rel="stylesheet" href="../src/css/style.css" />
  </head>
  <body>
    <div id="dashboard-container">
      <aside id="sidebar-panel">
        <header class="balance-header">
          <h2>Tổng quan số dư</h2>
          <p id="totalBalance" class="balance-amount">+5,500,000đ</p>
        </header>

        <section class="notifications-section">
          <h3>Thông báo <span id="transaction-count" class="badge">8</span></h3>
          <ul id="notificationList" class="notification-list">
            <li class="notification-item">
              <span class="tx-type tx-expense">Chi-</span>
              <span class="tx-desc">Ăn uống (2024-01-15)</span>
              <span class="tx-amount">-150,000đ</span>
            </li>
            <li class="notification-item">
              <span class="tx-type tx-income">Thu+</span>
              <span class="tx-desc">Lương tháng 1 (2024-01-10)</span>
              <span class="tx-amount">+10,000,000đ</span>
            </li>
            <li class="notification-item">
              <span class="tx-type tx-expense">Chi-</span>
              <span class="tx-desc">Di chuyển (2024-01-08)</span>
              <span class="tx-amount">-200,000đ</span>
            </li>
          </ul>
        </section>
      </aside>

      <main id="main-content">
        <div class="profile-area">
          <span id="profileName" class="profile-name">Demo User</span>
          <button id="btnLogout" class="logout-btn" onclick="window.location.href='index.html'">Đăng xuất</button>
        </div>

        <!-- Phần Tổng quan số liệu (US03) -->
        <div class="stats-overview">
          <div class="stat-card income-card">
            <div class="stat-icon">
              <i class="fas fa-arrow-up"></i>
            </div>
            <div class="stat-info">
              <h4>Tổng Thu</h4>
              <p id="totalIncome" class="stat-value">10,000,000đ</p>
            </div>
          </div>
          <div class="stat-card expense-card">
            <div class="stat-icon">
              <i class="fas fa-arrow-down"></i>
            </div>
            <div class="stat-info">
              <h4>Tổng Chi</h4>
              <p id="totalExpense" class="stat-value">4,500,000đ</p>
            </div>
          </div>
          <div class="stat-card balance-card">
            <div class="stat-icon">
              <i class="fas fa-wallet"></i>
            </div>
            <div class="stat-info">
              <h4>Số Dư</h4>
              <p id="mainBalance" class="stat-value">5,500,000đ</p>
            </div>
          </div>
        </div>

        <div class="charts">
          <div class="chart-card">
            <h3><i class="fas fa-chart-pie"></i> Chi tiêu theo danh mục</h3>
            <div id="categoryChartContainer">
              <canvas id="categoryChart"></canvas>
            </div>
          </div>
          <div class="chart-card">
            <h3><i class="fas fa-chart-bar"></i> Thu/Chi theo tháng</h3>
            <div id="monthlyChartContainer">
              <canvas id="monthlyChart"></canvas>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Dữ liệu mẫu cho demo US03
      const demoCategoryData = [
        { category: 'Ăn uống', total: 1500000, type: 'expense' },
        { category: 'Di chuyển', total: 800000, type: 'expense' },
        { category: 'Mua sắm', total: 1200000, type: 'expense' },
        { category: 'Giải trí', total: 1000000, type: 'expense' }
      ];

      const demoMonthlyData = [
        { month: '2023-11', income: 10000000, expense: 3500000 },
        { month: '2023-12', income: 10000000, expense: 4200000 },
        { month: '2024-01', income: 10000000, expense: 4500000 }
      ];

      // Format tiền tệ
      function formatCurrency(amount) {
        const num = Math.abs(Number(amount) || 0);
        return new Intl.NumberFormat("vi-VN").format(num) + "đ";
      }

      // Vẽ biểu đồ tròn - Chi tiêu theo danh mục
      const ctx1 = document.getElementById('categoryChart').getContext('2d');
      const categoryChart = new Chart(ctx1, {
        type: 'pie',
        data: {
          labels: demoCategoryData.map(d => d.category),
          datasets: [{
            data: demoCategoryData.map(d => d.total),
            backgroundColor: [
              '#e74c3c',
              '#3498db',
              '#2ecc71',
              '#f39c12'
            ]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              position: 'bottom'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const label = context.label || '';
                  const value = context.parsed || 0;
                  return label + ': ' + formatCurrency(value);
                }
              }
            }
          }
        }
      });

      // Vẽ biểu đồ cột - Thu/Chi theo tháng
      const ctx2 = document.getElementById('monthlyChart').getContext('2d');
      const monthlyChart = new Chart(ctx2, {
        type: 'bar',
        data: {
          labels: demoMonthlyData.map(d => {
            const [year, month] = d.month.split('-');
            return `${month}/${year}`;
          }),
          datasets: [
            {
              label: 'Thu nhập',
              data: demoMonthlyData.map(d => d.income),
              backgroundColor: 'rgba(46, 204, 113, 0.7)',
              borderColor: 'rgba(46, 204, 113, 1)',
              borderWidth: 1
            },
            {
              label: 'Chi tiêu',
              data: demoMonthlyData.map(d => d.expense),
              backgroundColor: 'rgba(231, 76, 60, 0.7)',
              borderColor: 'rgba(231, 76, 60, 1)',
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return formatCurrency(value);
                }
              }
            }
          },
          plugins: {
            legend: {
              position: 'top'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const label = context.dataset.label || '';
                  const value = context.parsed.y || 0;
                  return label + ': ' + formatCurrency(value);
                }
              }
            }
          }
        }
      });
    </script>
  </body>
</html>

